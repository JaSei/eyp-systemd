---
language: ruby
sudo: required
services:
  - docker
script:
  - bundle exec rspec spec/acceptance
bundler_args: --without system_tests
matrix:
  include:
  - rvm: default
    env: LINT=puppetcode
    dist: trusty
    bundler_args:
    script: bundle exec rake lint
  - rvm: default
    env: LINT=metadata
    dist: trusty
    bundler_args:
    script: bundle exec rake metadata_lint
  - rvm: default
    env: JOB=validate
    dist: trusty
    bundler_args:
    script: bundle exec rake validate
  - rvm: default
    env: BEAKER_set="centos7-docker"
    dist: trusty
    bundler_args:
    script: sudo service docker restart ; sleep 10 && bundle exec rspec spec/acceptance/*_spec.rb
  - rvm: default
    env: BEAKER_set="ubuntu16-docker"
    dist: trusty
    bundler_args:
    script: sudo service docker restart ; sleep 10 && bundle exec rspec spec/acceptance/*_spec.rb
  - rvm: 2.5.3
    bundler_args: --without development release
    env: PUPPET_INSTALL_TYPE=agent BEAKER_PUPPET_COLLECTION=puppet6 BEAKER_debug=true BEAKER_setfile=centos7 BEAKER_HYPERVISOR=docker CHECK=beaker
    services: docker